<div class="card-header text-dark d-flex justify-content-between align-items-center">
  <h2 mat-dialog-title>üìÑ Request Logs ({{ data.requestId }})</h2>

  <div class="d-flex align-items-center gap-2 px-2">
    <small
      class="badge rounded-pill px-2 py-1 fw-bold"
      [ngClass]="logsData.FinalStatusCode === 200 ? 'bg-success' : 'bg-danger'"
    >
      {{ logsData.FinalStatusCode }}
    </small>
    <!-- <button class="close-btn btn btn-sm btn-danger" (click)="logsData = null">Close</button> -->
  </div>
</div>
<mat-dialog-content class="mat-typography">
  <div class="card">
    <div class="card-body">
      <!-- Basic Info -->
      <h4 class="fw-bold mb-2">Basic Info</h4>
      <ul class="list-group mb-3">
        <li class="list-group-item"><b>Request ID:</b> {{ logsData.RequestId }}</li>
        <li class="list-group-item">
          <b>Timestamp:</b> {{ logsData.Timestamp | date: 'dd MMMM yyyy, hh:mm:ssa' }}
        </li>

        <li class="list-group-item"><b>Message:</b> {{ logsData.Message }}</li>
        <li class="list-group-item"><b>File Name:</b> {{ logsData.PDFUpload_FileName }}</li>

        <li class="list-group-item">
          <b>File Size:</b>
          {{ logsData.PDFUpload_FileSize_In_Bytes / (1024 * 1024) | number: '1.2-2' }} MB
        </li>

        <li class="list-group-item"><b>Final Status Code:</b> {{ logsData.FinalStatusCode }}</li>
      </ul>
    </div>
  </div>
  <!-- Processing Stages -->
  <h3 class="fw-bold mb-2">Processing Stages</h3>

  <!-- PDF Upload -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.PDFUpload_StatusCode !== 200,
      'border-success': logsData.PDFUpload_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">üì§ PDF Upload</h4>
      <b>Status:</b> {{ logsData.PDFUpload_Status }} <br />
      <b>Code:</b> {{ logsData.PDFUpload_StatusCode }} <br />
      <b>File Size:</b>
      {{ logsData.PDFUpload_FileSize_In_Bytes / (1024 * 1024) | number: '1.2-2' }} MB
    </div>
  </div>

  <!-- PDF Quality Check -->
  <!-- PDF Quality Check -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.PDFQualityCheck_StatusCode !== 200,
      'border-success': logsData.PDFQualityCheck_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">üßê PDF Quality Check</h4>
      <b>Status:</b> {{ logsData.PDFQualityCheck_Status }} <br />
      <b>Code:</b> {{ logsData.PDFQualityCheck_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.PDFQualityCheck_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds <br />
      <b>Blur Score:</b> {{ logsData.PDFQualityCheck_BlurScore | number: '1.0-2' }}
    </div>
  </div>
  <!-- PDF Enhancement -->
  <!-- PDF Enhancement -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.PDFEnhancement_StatusCode !== 200,
      'border-success': logsData.PDFEnhancement_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">‚ú® PDF Enhancement</h4>
      <b>Status:</b> {{ logsData.PDFEnhancement_Status }} <br />
      <b>Code:</b> {{ logsData.PDFEnhancement_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.PDFEnhancement_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>

  <!-- S3 Upload -->
  <!-- S3 Upload -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.S3Upload_StatusCode !== 200,
      'border-success': logsData.S3Upload_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">‚òÅÔ∏è S3 Upload</h4>
      <b>Status:</b> {{ logsData.S3Upload_Status }} <br />
      <b>Code:</b> {{ logsData.S3Upload_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.S3Upload_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>
  <!-- OCR -->
  <!-- OCR -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.OCR_StatusCode !== 200,
      'border-success': logsData.OCR_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">üîé OCR</h4>
      <b>Status:</b> {{ logsData.OCR_Status }} <br />
      <b>Code:</b> {{ logsData.OCR_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.OCR_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>
  <!-- LLM Postprocessing -->
  <!-- LLM Postprocessing -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.LLM_Postprocessing_StatusCode !== 200,
      'border-success': logsData.LLM_Postprocessing_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">üõ†Ô∏è LLM Postprocessing</h4>
      <b>Status:</b> {{ logsData.LLM_Postprocessing_Status }} <br />
      <b>Code:</b> {{ logsData.LLM_Postprocessing_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.LLM_Postprocessing_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>
  <!-- LLM Confidence Scoring -->
  <!-- LLM Confidence Scoring -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.LLM_ConfidenceScoring_StatusCode !== 200,
      'border-success': logsData.LLM_ConfidenceScoring_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">üìä LLM Confidence Scoring</h4>
      <b>Status:</b> {{ logsData.LLM_ConfidenceScoring_Status }} <br />
      <b>Code:</b> {{ logsData.LLM_ConfidenceScoring_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.LLM_ConfidenceScoring_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>
  <!-- LLM Validation -->
  <!-- LLM Validation -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.LLM_Validation_StatusCode !== 200,
      'border-success': logsData.LLM_Validation_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h5 class="card-title">ü§ñ LLM Validation</h5>
      <b>Status:</b> {{ logsData.LLM_Validation_Status }} <br />
      <b>Code:</b> {{ logsData.LLM_Validation_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.LLM_Validation_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>
  <!-- Excel Generation -->
  <!-- Excel Generation -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.ExcelGeneration_StatusCode !== 200,
      'border-success': logsData.ExcelGeneration_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">üìë Excel Generation</h4>
      <b>Status:</b> {{ logsData.ExcelGeneration_Status }} <br />
      <b>Code:</b> {{ logsData.ExcelGeneration_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.ExcelGeneration_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>
  <!-- Excel Storage -->
  <!-- Excel Storage -->
  <div
    class="card mb-2 p-3"
    [ngClass]="{
      'border-danger': logsData.ExcelStorage_StatusCode !== 200,
      'border-success': logsData.ExcelStorage_StatusCode === 200,
    }"
  >
    <div class="card-body">
      <h4 class="card-title fw-bold">üíæ Excel Storage</h4>
      <b>Status:</b> {{ logsData.ExcelStorage_Status }} <br />
      <b>Code:</b> {{ logsData.ExcelStorage_StatusCode }} <br />
      <b>Processing Time:</b>
      {{ logsData.ExcelStorage_ProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </div>
  </div>
  <!-- Extra Info -->
  <div class="mt-3">
    <p>
      <b>Total Processing Time:</b>
      {{ logsData.TotalProcessingTimeMs / 1000 | number: '1.2-2' }} seconds
    </p>

    <p><b>Retry Count:</b> {{ logsData.RetryCount }}</p>
    @if (logsData.ErrorCode && logsData.ErrorCode !== 'N/A') {
      <p><b>Error Code:</b> {{ logsData.ErrorCode }}</p>
    }
    @if (logsData.ErrorMessage && logsData.ErrorMessage !== 'N/A') {
      <p><b> Message:</b> {{ logsData.ErrorMessage }}</p>
    }
    @if (logsData.ErrorResolution && logsData.ErrorResolution !== 'N/A') {
      <p><b>Error Resolution:</b> {{ logsData.ErrorResolution }}</p>
    }
    @if (logsData.OriginalErrorMessage && logsData.OriginalErrorMessage !== '') {
      <p><b>Original Error:</b> {{ logsData.OriginalErrorMessage }}</p>
    }
  </div>

  <!-- </div> -->
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button color="accent" matButton="elevated" mat-dialog-close color="accent">Close</button>
  <!-- <button matButton [mat-dialog-close]="true" cdkFocusInitial>Install</button> -->
</mat-dialog-actions>
