<!-- {{ selectedBtn }}
{{ reportForm.get('reportType')?.value }}
{{ reportForm.get('valueType')?.value }}
{{ reportForm.get('currencyFormat')?.value }} -->
<section class="my-4">
  <!-- Buttons -->
  <div class="d-flex my-4 overflow-x-auto">
    @for (btn of buttons; track $index) {
      <button
        role="button"
        class="btn rounded-5 m-2 text-nowrap"
        [ngClass]="selectedBtn === btn.key ? 'btn-cfPrimary' : 'btn-outline-cfPrimary'"
        (click)="buttonClick(btn.key)"
      >
        {{ btn.label }}
      </button>
    }
  </div>

  <!-- Filter -->
  <form
    [formGroup]="reportForm"
    class="border rounded bg-light p-4 d-flex gap-2 flex-wrap justify-content-md-around align-items-center"
  >
    <!-- Report Type & Value Format -->
    @for (group of radioOptions; track $index) {
      <div>
        <p class="fw-bold mb-2">{{ group.title }}</p>
        <div>
          @for (option of group.options; track option.key) {
            <input
              type="radio"
              [id]="option.key"
              [value]="option.key"
              [formControlName]="group.controlName"
              class="me-1"
            />
            <label [for]="option.key" class="me-3">{{ option.label }}</label>
          }
        </div>
      </div>
    }

    <!-- Currency Format Dropdown -->
    <div>
      <label for="currencyFormat" class="d-block fw-bold mb-2">Display Numbers In</label>
      <select id="currencyFormat" formControlName="currencyFormat" class="form-select w-100">
        @for (format of currencyFormats; track format.key) {
          <option [value]="format.key">{{ format.label }}</option>
        }
      </select>
    </div>
  </form>
</section>

<!-- Table data. -->
<div class="my-4 table-container">
  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 border rounded">
    @for (item of headers; track $index) {
      <ng-container [matColumnDef]="item.key" [sticky]="$index === 0">
        <th mat-header-cell *matHeaderCellDef class="text-center fw-bold bg-secondary-subtle">
          {{ item.value }}
        </th>
        <td mat-cell *matCellDef="let element" [class]="item.class + ' ' + element.class">
          <!-- {{ item.number }} -->
          <!-- {{ element | json }} -->

          @if (item.number && !element['isHeader']) {
            {{ getFormattedValue(element[item.key]) | inrFormat: currencyFormat : currencyOptions }}
          } @else {
            {{ element[item.key] }}
          }
          <!-- Add info icon -->
          @if (element.info && item.key === 'lineItem') {
            <i
              class="bi bi-info-circle"
              matTooltip="{{ element.info }}"
              matTooltipPosition="above"
            ></i>
          }
        </td>
      </ng-container>
    }

    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</div>

<div class="text-end my-4">
  <i class="bi bi-file-earmark-pdf-fill text-danger"></i>
  <a [href]="fileLink" class="custom-font-size-6">
    How We Standardize Annual Financial Statements?
  </a>
</div>

<!-- Download report section -->
<div class="my-4 overflow-x-auto">
  <table mat-table [dataSource]="downloadReportsDataSource" class="border">
    @for (item of downloadReportsHeaders; track $index) {
      <ng-container [matColumnDef]="item.key">
        <th mat-header-cell *matHeaderCellDef class="bg-secondary-subtle fw-bold text-center">
          {{ item.value }}
        </th>
        <td mat-cell *matCellDef="let element" [class]="item.class">
          @if (element[item.key] === 'pdf') {
            <button
              type="button"
              class="btn-icon"
              (click)="onFileClick('pdf', item.value)"
              aria-label="Open PDF"
            >
              <i class="bi bi-file-earmark-pdf-fill text-danger fs-4"></i>
            </button>
          } @else if (element[item.key] === 'excel') {
            <button
              type="button"
              class="btn-icon"
              (click)="onFileClick('excel', item.value)"
              aria-label="Open Excel"
            >
              <i class="bi bi-file-earmark-spreadsheet-fill text-success fs-4"></i>
            </button>
          } @else {
            {{ element[item.key] }}
          }
        </td>
      </ng-container>
    }

    <tr mat-header-row *matHeaderRowDef="downloadReportsDisplayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: downloadReportsDisplayedColumns"></tr>
  </table>
</div>

<!-- Note -->
<p class="text-secondary my-4 custom-font-size-6">
  * PDF consists of final financial dataset as published by the ULB. Excel File contains
  standardised data from this raw PDF to enable comparison and analysis.
</p>
