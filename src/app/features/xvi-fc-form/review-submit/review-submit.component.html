@for (tab of fields; track tab.key; let i = $index) {

<div class="container mt-4" [id]="tab.key">
    <div class="text-bg-light border rounded mt-3 mb-3 p-3 d-flex justify-content-between align-items-center"
        *ngIf="tab.key !== 'reviewSubmit'" [ngClass]="!isFormValid(tab.key) ? 'border-danger': ''">
        <div>
            <p class="text-muted pb-2">Section {{tab.displayPriority}}/ {{fields.length}}</p>
            <h4 class="fw-bold">{{tab.label}}</h4>
        </div>

        <div>
            <button matStepperNext class="btn btn-outline-dark fw-bold" (click)="editStep(i)">
                <i class="bi bi-pencil-square me-2 fs-5"></i>
                Edit</button>
                <!-- <button (click)="printPage()">Print</button> -->
        </div>
    </div>

    @if (tab.key === 'demographicData') {
    <mat-card [ngClass]="!isFormValid(tab.key) ? 'border border-danger': ''">
        <mat-card-content>
            <!-- <div class="border border-secondary-subtle rounded p-3"> -->
            <table class="table table-borderless table-hover">
                <tbody>
                    <tr *ngFor="let field of tab?.data;let i = index;">
                        <!-- <td>{{field.position}}.</td> -->
                        <td class="first-col"><span align="right">{{field.position ?
                                field.position+'.':''}}&nbsp;</span>{{field.label}}<sup
                                class="text-danger fw-bold">*</sup>
                        </td>
                        <td class="fw-bold"> {{field.value ? field.value : 'N/A'}} </td>
                        <!-- <td class="fw-bold"
                        [align]="field.formFieldType==='number' || field.formFieldType==='amount' ? 'right' :'left'">
                        {{field.value}}
                    </td> -->
                    </tr>
                </tbody>
            </table>
            <!-- </div> -->
        </mat-card-content>
    </mat-card>

    }
    @else if (tab.key === 'financialData' || tab.key === 'serviceLevelBenchmark') {
    <ng-container *ngFor="let field of tab?.data;let i = index;">
        <mat-expansion-panel [expanded]="panelOpenState" class="mt-3"
            [ngClass]="!isFormValid(tab.key) ? 'border border-danger': ''">
            <mat-expansion-panel-header *ngIf="field.key !== 'commonPrimaryKey'">
                <mat-panel-title>
                    {{field.label}}
                </mat-panel-title>
            </mat-expansion-panel-header>

            <div class="table-container">
                <table class="table table-borderless table-hover table-responsive">
                    <thead>
                        <tr class="border-bottom">
                            <th class="first-col"></th>
                            <th *ngFor="let year of field.data[0].year; let i = index;" class="fw-bold"
                                class="text-end">
                                {{year.label }}
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let row of field.data; let i = index;" class="{{ row.class }}">
                            <td class="first-col {{ row.class }}">
                                <span align="right">{{ row.position ? row.position + '. ' : '' }}&nbsp;</span>{{
                                row.label }}
                                <sup class="text-danger fw-bold" *ngIf="row.required">*</sup>
                            </td>
                            <td align="right" class="fw-bold" *ngFor="let col of row.year; let j = index;">
                                <ng-container *ngIf="col.formFieldType == 'amount'; else otherField">
                                    <span matTextPrefix>&nbsp;</span>{{ col.value ? (col.value |
                                    currency:'INR':'symbol':'1.0-0') :'N/A' }}
                                </ng-container>
                                <ng-template #otherField>
                                    <!-- {{ col.value }} -->
                                    {{ col.value ? col.value : 'N/A' }}
                                </ng-template>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>


        </mat-expansion-panel>
    </ng-container>
    }
    @else if (tab.key === 'uploadDoc') {
    <mat-expansion-panel [expanded]="panelOpenState" class="mt-3"
        [ngClass]="!isFormValid(tab.key) ? 'border border-danger': ''">
        <mat-expansion-panel-header>
            <mat-panel-title>
                Copy of Audited Annual Financial Statements
            </mat-panel-title>
        </mat-expansion-panel-header>
        <!-- <div class="audited-statement-block"> -->
        <div class="py-4 dotted-border-bottom-primary" *ngFor="let year of tab.data[0].year; index as i">
            <h5 class="fw-bold mb-3">{{year.label}}</h5>
            @if (year.isPdfAvailable) {

            <div class="uploaded-files">

                <div class="border rounded border-secondary-subtle bg-light p-3">
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex justify-content-start align-items-center">
                            <div class="">
                                <i class="bi bi-file-earmark-pdf-fill fs-4 me-2 text-danger "></i>
                                <p class="d-inline">Already available on CityFinance</p>
                            </div>
                        </div>
                        <!-- <div class="align-self-center delete-doc-icon">
                            <button class="ms-2 primary-btn-2">View</button>
                        </div> -->
                    </div>
                </div>


                <!-- verified by ulb -->
                @if(year.verifyStatus === 2) {
                <div class="verified-info">
                    <div class="d-flex align-items-center justify-content-start">
                        <span><mat-icon class="material-icons-round  me-2 text-success"> verified </mat-icon></span>
                        <p>
                            You have successfully verified the document already available on City Finance and
                            accepted it.
                        </p>
                    </div>
                </div>
                }

                @else if (year.verifyStatus === 3) {


                <p class="mt-3 mb-1">Uploaded Files</p>

                <div class="d-flex border rounded align-items-center p-3">
                    <div class="flex-shrink-0">
                        <i class="bi bi-file-earmark-pdf-fill fs-4 me-2 text-danger "></i>
                    </div>
                    <div class="flex-grow-1">
                        <p>Add file name in .ts file</p>
                        <p>Add size here</p>
                    </div>
                    <div class="flex-shrink-0">
                        <a href="#"><i class="bi bi-eye-fill fs-5 me-1 text-dark"></i></a>
                    </div>
                </div>

                <!-- rejected by ulb -->
                <div class="verified-info verified-info-reject">
                    <div class="d-flex align-items-center justify-content-start">
                        <span><mat-icon class="material-icons-round me-2 text-danger"> verified </mat-icon></span>
                        <div>
                            <p>
                                You have rejected the existing document(s) on City Finance and re-uploaded a new
                                consolidated file.
                            </p>
                            <!-- <p> <strong>Reason:</strong> {{getYearGroup(i,year.key).getRawValue().rejectReason}} </p> -->
                            <p> <strong>Reason:</strong> {{year.rejectReason}} </p>
                        </div>
                    </div>
                </div>


                <!-- 
                <div class="d-flex border rounded align-items-center p-3"
                    *ngIf="getYearGroup(i,year.key).get('file')?.getRawValue().name">
                    <div class="flex-shrink-0">
                        <i class="bi bi-file-earmark-pdf-fill fs-4 me-2 text-danger "></i>
                    </div>
                    <div class="flex-grow-1">
                        <p>{{getYearGroup(i,year.key).get('file')?.getRawValue().name}}</p>
                        <p class="file-size">{{getYearGroup(i,year.key).get('file')?.getRawValue().size}}</p>
                    </div>
                    <div class="flex-shrink-0">
                        <i class="bi bi-trash3-fill fs-4 me-1 text-danger" (click)="deleteFile(year.key)"></i>
                    </div>
                </div> -->
                }


            </div>
            } @else {
            <div class="files-list">
                <p class="mb-1">Uploaded file: <span class="fw-bold" *ngIf="!year.file.name">N/A</span></p>


                <div class="d-flex dotted-border-secondary p-3" *ngIf="year.file.name">
                    <div class="flex-shrink-0">
                        <i class="bi bi-file-earmark-pdf-fill fs-4 me-1 text-danger"></i>
                    </div>
                    <div class="flex-grow-1 ms-2">
                        <h4 class="name"> {{ year.file.name }} </h4>
                    </div>
                    <div class="align-self-center">
                        <!-- <div class="delete align-self-center" (click)="deleteFile()"> -->
                        <a [href]="year.file.url | toStorageUrl" target="_blank"><i
                                class="bi bi-eye-fill fs-5 me-1 text-dark"></i></a>
                    </div>
                </div>

            </div>
            <!-- <app-file [field]="year" [group]="getFileGroup(year.key,i)"></app-file> -->
            }
        </div>

        <!-- </div> -->
    </mat-expansion-panel>
    }
    @else if (tab.key === 'accountPractice') {
    <mat-expansion-panel [expanded]="panelOpenState" class="mt-3"
        [ngClass]="!isFormValid(tab.key) ? 'border border-danger': ''" *ngFor="let field of tab.data">
        <mat-expansion-panel-header>
            <mat-panel-title>
                {{field.label}}
            </mat-panel-title>
        </mat-expansion-panel-header>

        <table class="table table-borderless table-hover table-responsive">
            <tbody>
                <tr *ngFor="let question of field.data" class="row">
                    <!-- <td>{{question.position}}.</td> -->
                    <td class="col-7">{{question.position}}.&nbsp;{{question.label}}<sup class="text-danger fw-bold"
                            *ngIf="question.required">*</sup></td>
                    <td class="col-5">
                        <!-- <p class="fw-bold" [ngClass]="{'text-end': question.formFieldType =='number'}"> -->
                        <p class="fw-bold">
                            {{ question.value ? question.value : 'N/A' }}
                        </p>
                        <p *ngIf="question.reason" class="text-secondary mt-1">{{question.reason}}</p>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- <ng-container *ngFor="let question of field.data">
            <label class="pt-3 pb-1 fw-bold" for="{{question.key}}">
                {{question.position}}.
                {{question.label}}
            </label>
            @if (question.formFieldType === 'radio') {
            <div class="form-check pt-1" *ngFor="let optionValue of question.options; index as i">
                <label class="form-check-label" [attr.for]="question.key+i">
                    {{optionValue.id ? optionValue.id: optionValue }}
                </label>
                @if (optionValue.showInputBox) {
                <input class="form-control" type="text" [value]="question.inputBoxValue" />
                }
            </div>
            } @else if (question.formFieldType === 'number') {
            <input class="form-control" [type]="question.formFieldType" [value]="question.value" />
            }
        </ng-container> -->
    </mat-expansion-panel>
    }
</div>

}
<style type="text/css" media="print">
    @page 
    {
        size:  auto;   /* auto is the initial value */
        margin: 0mm;  /* this affects the margin in the printer settings */
    }

    html
    {
        background-color: #FFFFFF; 
        margin: 0px;  /* this affects the margin on the html before sending to printer */
    }

    body
    {
        border: solid 0px blue ;
        margin: 10mm 15mm 10mm 15mm; /* margin you want for the content */
    }
    .no-print,bg-white,.footer-wrappper {
      display: none;
    }
  
    body {
      background: white;
    }
    </style>